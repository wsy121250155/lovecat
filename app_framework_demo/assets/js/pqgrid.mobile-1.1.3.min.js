(function(e){"use strict";e.paramquery=e.paramquery==null?{}:e.paramquery,e.paramquery.xmlToArray=function(t,n){var r=n.itemParent,i=n.itemNames,s=[],o=e(t).find(r);return o.each(function(t,n){var r=e(n),o=[];e(i).each(function(e,t){o.push(r.find(t).text())}),s.push(o)}),s},e.paramquery.tableToArray=function(t){var n=e(t),r=[],i=[],s=[],o=[],u=n.find("tr:first"),a=n.find("tr:eq(1)");return u.find("th,td").each(function(t,n){var i=e(n),s=i.html(),o=i.width(),u="string",f=a.find("td:eq("+t+")"),l=f.text(),c=f.attr("align");l=l.replace(/,/g,""),parseInt(l)==l&&(parseInt(l)+"").length==l.length?u="integer":parseFloat(l)==l&&(u="float");var h={title:s,width:o,dataType:u,align:c,dataIndx:t};r.push(h)}),n.find("tr").each(function(t,n){if(t==0)return;var r=e(n),s=[];r.find("td").each(function(t,n){s.push(e.trim(e(n).html()))}),i.push(s)}),{data:i,colModel:r}},e.paramquery.formatCurrency=function(e){e=Math.round(e*10)/10,e+="",e.indexOf(".")==-1&&(e+=".0");var t=e.length,n=e.substring(0,t-2),r=e.substring(t-2,t),i=n.match(/\d/g).reverse(),s=[];for(var o=0;o<i.length;o++)o>0&&o%3==0&&s.push(","),s.push(i[o]);return s=s.reverse(),n=s.join(""),n+r}})(jQuery),function(e){"use strict";var t={};t.options={currentPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},t._regional={strPage:"Page {0} of {1}",strFirstPage:"First Page",strPrevPage:"Previous Page",strNextPage:"Next Page",strLastPage:"Last Page",strRefresh:"Refresh",strRpp:"Records per page:",strDisplay:"Displaying {0} to {1} of {2} items."},e.extend(t.options,t._regional),t._create=function(){var t=this,n=this.options;this.element.addClass("pq-pager").css({}),this.first=e("<button type='button' title='"+this.options.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"pq-page-first"},text:!1}).bind("click.paramquery",function(e){t.options.currentPage>1&&t._trigger("change",e,{curPage:1})!==!1&&t.option({currentPage:1})}),this.prev=e("<button type='button' title='"+this.options.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"pq-page-prev"},text:!1}).bind("click",function(e){if(t.options.currentPage>1){var n=t.options.currentPage-1;t._trigger("change",e,{curPage:n})!==!1&&t.option({currentPage:n})}}),e("<span class='pq-separator'></span>").appendTo(this.element),this.pagePlaceHolder=e("<span class='pq-pageholder'></span>").appendTo(this.element),e("<span class='pq-separator'></span>").appendTo(this.element),this.next=e("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"pq-page-next"},text:!1}).bind("click",function(e){var n=t.options.currentPage+1;t._trigger("change",e,{curPage:n})!==!1&&t.option({currentPage:n})}),this.last=e("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"pq-page-last"},text:!1}).bind("click",function(e){var n=t.options.totalPages;t._trigger("change",e,{curPage:n})!==!1&&t.option({currentPage:n})}),e("<span class='pq-separator'></span>").appendTo(this.element),this.$strRpp=e("<span>"+this.options.strRpp+" </span>").appendTo(this.element),this.$rPP=e("<select></select>").appendTo(this.element).change(function(n){var r=e(this).val();t._trigger("change",n,{rPP:r})!==!1&&(t.options.rPP=r)}),e("<span class='pq-separator'></span>").appendTo(this.element),this.$refresh=e("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"pq-refresh"},text:!1}).bind("click",function(e){t._trigger("refresh",e)!==!1}),e("<span class='pq-separator'></span>").appendTo(this.element),this.$msg=e("<span class='pq-pager-msg'></span>").appendTo(this.element),this._refresh()},t._refreshPage=function(){var t=this;this.pagePlaceHolder.empty();var n=this.options.strPage,r=n.split(" "),i="";e(r).each(function(e,t){i+="<span>"+t+"</span>"}),n=i.replace("<span>{0}</span>","<span class='textbox'></span>"),n=n.replace("<span>{1}</span>","<span class='total'></span>");var s=e(n).appendTo(this.pagePlaceHolder);this.page=e("<input type='text' tabindex='0' />").replaceAll("span.textbox",s).bind("change",function(n){var r=e(this),i=r.val();if(isNaN(i)||i<1)return r.val(t.options.currentPage),!1;i=parseInt(i);if(i>t.options.totalPages)return r.val(t.options.currentPage),!1;if(t._trigger("change",n,{curPage:i})===!1)return r.val(t.options.currentPage),!1;t.option({currentPage:i})}),this.$total=s.filter("span.total")},t._refresh=function(){this._refreshPage();var e=this.$rPP,t=this.options;this.$strRpp.text(t.strRpp),this.first.attr("title",t.strFirstPage),this.prev.attr("title",t.strPrevPage),this.next.attr("title",t.strNextPage),this.last.attr("title",t.strLastPage),this.$refresh.attr("title",t.strRefresh),e.empty();var n=this.options.rPPOptions;for(var r=0;r<n.length;r++){var i=document.createElement("option");i.text=n[r],i.value=n[r],i.setAttribute("value",n[r]),i.innerHTML=n[r],e.append(i)}e.find("option[value="+this.options.rPP+"]").attr("selected",!0),this.options.currentPage>=this.options.totalPages?(this.next.button({disabled:!0}),this.last.button({disabled:!0})):(this.next.button({disabled:!1}),this.last.button({disabled:!1})),this.options.currentPage<=1?(this.first.button({disabled:!0}),this.prev.button({disabled:!0})):(this.first.button({disabled:!1}),this.prev.button({disabled:!1})),this.page.val(this.options.currentPage),this.$total.text(this.options.totalPages);if(this.options.totalRecords>0){var s=this.options.rPP,o=this.options.currentPage,u=this.options.totalRecords,a=(o-1)*s,f=o*s;f>u&&(f=u);var l=this.options.strDisplay;l=l.replace("{0}",a+1),l=l.replace("{1}",f),l=l.replace("{2}",u),this.$msg.html(l)}else this.$msg.html("")},t._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()},t._setOption=function(t,n){if(t=="currentPage"||t=="totalPages")n=parseInt(n);e.Widget.prototype._setOption.call(this,t,n)},t._setOptions=function(){e.Widget.prototype._setOptions.apply(this,arguments),this._refresh()},e.widget("paramquery.pqPager",t),e.paramquery.pqPager.regional={},e.paramquery.pqPager.regional.en=t._regional,e.paramquery.pqPager.setDefaults=function(n){for(var r in n)t.options[r]=n[r];e.widget("paramquery.pqPager",t),e(".pq-pager").each(function(t,r){e(r).pqPager("option",n)})}}(jQuery),function(e){"use strict";var t={};t.options={length:200,num_eles:3,cur_pos:0,timeout:350,pace:"optimum",direction:"vertical"},t._destroy=function(){this.element.removeClass("pq-scrollbar-vert").enableSelection().removeClass("pq-scrollbar-horiz").unbind("click.pq-scrollbar").empty(),this.element.removeData()},t._create=function(){function i(e){t.options.cur_pos>0&&(t.options.cur_pos--,t.updateSliderPos(),t.scroll(e))}function s(e){t.options.cur_pos<t.num_eles-1&&t.options.cur_pos++,t.updateSliderPos(),t.scroll(e)}this.length=this.options.length,this.direction=this.options.direction,this.num_eles=this.options.num_eles;var t=this,n=this.element.empty();this.direction=="vertical"?(n.addClass("pq-scrollbar-vert"),n.html("<div class='pq-sb-slider'>				<div class='vert-slider-top'></div>				<div class='vert-slider-bg'></div>				<div class='vert-slider-center'></div>				<div class='vert-slider-bg'></div>				<div class='vert-slider-bottom'></div>			</div>")):(n.addClass("pq-scrollbar-horiz"),n.width(this.width),n.html("<div class='pq-sb-slider pq-sb-slider-h'>				<span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span>			</div>")),this.element.disableSelection().bind("click.pq-scrollbar",function(e){if(t.options.disabled)return;if(t.$slider.is(":hidden"))return;if(t.direction=="vertical"){var n=e.pageY,r=t.element.offset().top,i=r+t.length,s=t.$slider.offset().top,o=s+t.$slider.height();if(n<s&&n>r){var u=n-r;t.$slider.css("top",u),t._updateCurPosAndTrigger(e)}else n>o&&n<i&&(t.$slider.css("top",n-r-t.$slider.height()),t._updateCurPosAndTrigger(e))}else{var a=e.pageX,s=t.$slider.offset().left,o=s+t.$slider.width();a<s?(t.$slider.css("left",a-t.element.offset().left),t._updateCurPosAndTrigger(e)):a>o&&(t.$slider.css("left",a-t.element.offset().left-t.$slider.width()),t._updateCurPosAndTrigger(e))}});var r="x";this.direction=="vertical"&&(r="y"),this.$slider=e("div.pq-sb-slider",this.element).draggable({axis:r,helper:function(e,n){return t._setDragLimits(),this},start:function(e){t.topWhileDrag=null},drag:function(e){t.dragging=!0;var n=t.options.pace;n=="optimum"?t._setNormalPace(e):n=="fast"&&t._updateCurPosAndTrigger(e)},stop:function(e){t._updateCurPosAndTrigger(e),t.dragging=!1,t._refresh()}}),this.$top_btn=e("div.top-btn,div.left-btn",this.element).click(function(e){if(t.options.disabled)return;return i(e),e.preventDefault(),!1}).mousedown(function(e){if(t.options.disabled)return;t.mousedownTimeout=window.setTimeout(function(){t.mousedownInterval=window.setInterval(function(){i(e)},50)},t.options.timeout)}).bind("mouseup mouseout",function(e){if(t.options.disabled)return;t._mouseup(e)}),this.$bottom_btn=e("div.bottom-btn,div.right-btn",this.element).click(function(e){if(t.options.disabled)return;return s(e),e.preventDefault(),!1}).mousedown(function(e){if(t.options.disabled)return;t.mousedownTimeout=window.setTimeout(function(){t.mousedownInterval=window.setInterval(function(){s(e)},50)},t.options.timeout)}).bind("mouseup mouseout",function(e){if(t.options.disabled)return;t._mouseup(e)}),this._refresh()},t._mouseup=function(e){if(this.options.disabled)return;var t=this;window.clearTimeout(t.mousedownTimeout),t.mousedownTimeout=null,window.clearInterval(t.mousedownInterval),t.mousedownInterval=null},t._setDragLimits=function(){if(this.direction=="vertical"){var e=this.element.offset().top,t=e+this.length-this.slider_length;this.$slider.draggable("option","containment",[0,e,0,t])}else{var e=this.element.offset().left,t=e+this.length-this.slider_length;this.$slider.draggable("option","containment",[e,0,t,0])}},t._refresh=function(){this.options.num_eles<=1?this.element.css("display","none"):this.element.css("display",""),this.num_eles=this.options.num_eles,this.length=this.options.length,this._validateCurPos(),this.$slider.css("display",""),this.direction=="vertical"?(this.element.height(this.length),this._setSliderBgLength(),this.scroll_space=this.length-this.slider_length,(this.scroll_space<4||this.num_eles<=1)&&this.$slider.css("display","none"),this.updateSliderPos(this.options.cur_pos)):(this.element.width(this.length),this._setSliderBgLength(),this.scroll_space=this.length-this.slider_length,(this.scroll_space<4||this.num_eles<=1)&&this.$slider.css("display","none"),this.updateSliderPos(this.options.cur_pos))},t._setSliderBgLength=function(){var t=this.length,n=this.num_eles*40+t,r=t,i=r*t/n,s=Math.round((i-14)/2);s<1&&(s=1),this.slider_length=14+2*s,this.direction=="vertical"?(e("div.vert-slider-bg",this.element).height(s),this.$slider.height(this.slider_length)):(e(".horiz-slider-bg",this.element).width(s),this.$slider.width(this.slider_length))},t._updateCurPosAndTrigger=function(e,t){var n=this,r=n.$slider;t==null&&(t=n.direction=="vertical"?parseInt(r[0].style.top):parseInt(r[0].style.left));var i=n.length-(n.direction=="vertical"?r[0].offsetHeight:r[0].offsetWidth),s=t*(n.num_eles-1)/i;s=Math.round(s);if(n.options.cur_pos!=s){if(this.dragging){if(this.topWhileDrag!=null){if(this.topWhileDrag<t&&n.options.cur_pos>s)return;if(this.topWhileDrag>t&&n.options.cur_pos<s)return}this.topWhileDrag=t}n.options.cur_pos=s,this.scroll(e)}},t._setNormalPace=function(e){this.timer&&(window.clearInterval(this.timer),this.timer=null);var t=this;t.timer=window.setInterval(function(){var n=t.$slider,r=t.direction=="vertical"?parseInt(n[0].style.top):parseInt(n[0].style.left);t.prev_top==r&&(t._updateCurPosAndTrigger(e,r),window.clearInterval(t.timer),t.timer=null),t.prev_top=r},20)},t.setNumEles=function(e){this.num_eles=this.options.num_eles=e,this.updateSliderPos()},t._validateCurPos=function(){this.options.cur_pos>=this.num_eles&&(this.options.cur_pos=this.num_eles-1),this.options.cur_pos<0&&(this.options.cur_pos=0)},t.updateSliderPos=function(){var e=this.scroll_space*this.options.cur_pos/(this.num_eles-1);this.direction=="vertical"?this.$slider.css("top",e):this.$slider.css("left",e)},t.scroll=function(e){var t=this.options;this._trigger("scroll",e,{cur_pos:t.cur_pos,num_eles:t.num_eles})},t._setOption=function(t,n){t=="disabled"&&(n==1?this.$slider.draggable("disable"):this.$slider.draggable("enable")),e.Widget.prototype._setOption.call(this,t,n)},t._setOptions=function(){e.Widget.prototype._setOptions.apply(this,arguments),this._refresh()},e.widget("paramquery.pqScrollBar",t)}(jQuery),function(e){"use strict";var t=function(e){this.that=e},n=t.prototype;n._generateTables=function(t){var n=this.that,r=n.colModel,i=r.length,s=n.options,o=s.columnBorders,u=s.rowBorders,a=s.scrollModel,f=n.outerWidths;n._bufferObj_calcInitFinal();var l=t?0:n.init,c=t?t.data.length-1:n["final"],h=t&&t.data?t.data:n.data,p=n.getRowIndxOffset();if(!t&&(l==null||c==null)){n.$cont.empty(),n.$tbl=null;return}t||n._trigger("beforeTableView",null,{data:n.data,curPos:l,finalPos:c,curPage:n.dataModel.curPage});var d="pq-grid-cell ";if(!s.wrap||t)d+="pq-wrap-text ";var v="pq-grid-table ";o&&(v+="pq-grid-td-border-right "),u&&(v+="pq-grid-td-border-bottom ");var m=["<table class='"+v+"' cellpadding=0 cellspacing=0 >"],g=[];m.push("<tr class='pq-row-hidden'>");if(n.numberCell){var y=n.numberCellWidth+1;m.push("<td style='width:"+y+"px;' ></td>")}for(var b=0;b<i;b++){var w=r[b];if(w.hidden)continue;if(n.hidearrHS[b]){g.push(b);continue}var y=f[b];m.push("<td style='width:"+y+"px;' pq-top-col-indx="+b+"></td>")}for(var E=0;E<g.length;E++){var b=g[E],w=r[b],y=f[b];m.push("<td style='width:"+y+"px;'></td>")}m.push("</tr>"),this.offsetRow=null;do{var S=h[l],x=S,T=l,N=x.hidden,C="";if(N){if(l==c)break;l++;continue}this.offsetRow==null&&T!=null&&(this.offsetRow=l-T),this._generateRow(x,T,r,i,g,p,d,m,t);if(!a.scrollTillLastRow){if(l==c)break;l++}}while(!0);n.scrollMode=!1,a.scrollTillLastRow||e.measureTime(function(){m.push("</table>");var r=m.join("");if(t){t.$cont.empty();var i=e(r);t.$cont.append(i),n.tables||(n.tables=[]);var s=-1;for(var o=0;o<n.tables.length;o++){var u=n.tables[o].cont;u==t.$cont[0]&&(s=o)}s==-1?n.tables.push({$tbl:i,cont:t.$cont[0]}):n.tables[s].$tbl=i}else n.$tbl==undefined?(n.$tbl=e(r),n.$cont.append(n.$tbl)):(n.$td_edit!=null&&n.quitEditMode(),n.$cont.empty(),n.$tbl=e(r),n.$cont.append(n.$tbl))},"append stuff inside _generateTable"),t||window.setTimeout(function(){n._fixTableViewPort(),n._trigger("refresh",null,{dataModel:n.dataModel,data:n.data,initV:n.init,initH:n.initH})},0)},n._renderCell=function(e){var t=this.that,n=e.rowIndxPage,r=e.rowIndx,i=e.rowData,s=e.colIndx,o=e.$td,u=e.column,a=u.dataIndx,f=e.wrap,l=e.customData,c;u.render?c=u.render({data:t.data,dataModel:t.dataModel,rowData:i,rowIndxPage:n,rowIndx:r,colIndx:s,column:u,dataIndx:a,customData:l}):c=i[a];if(c===""||c==undefined)c="&nbsp;";var h="pq-td-div";f==0&&(h+=" pq-wrap-text");var p="<div class='"+h+"'>"+c+"</div>";return o!=undefined&&o.html(p),p},n._generateRow=function(e,t,n,r,i,s,o,u,a){var f="pq-grid-row",l=this.that,c=l.options,h=c.columnBorders,p=c.wrap,d=c.customData,v={rowIndx:t+s,rowIndxPage:t,rowData:e,wrap:p,customData:d};c.oddRowsHighlight&&t/2==parseInt(t/2)&&(f+=" pq-grid-oddRow"),e.selectedRow&&(f+=" pq-row-select ui-state-highlight"),u.push("<tr pq-row-indx='"+t+"' class='"+f+"' >"),l.numberCell&&u.push("<td style='width:"+l.numberCellWidth+"px;' class='pq-grid-number-cell ui-state-default'>		<div class='pq-td-div'>"+(a?"&nbsp;":t+1)+"</div></td>");for(var m=0;m<r;m++){var g=n[m],y=g.dataIndx;v.column=g,v.colIndx=m;var b=!1,w=e.selectedDataIndices;w&&(b=w[y]);if(g.hidden)continue;if(l.hidearrHS[m])continue;var E="",S=o;g.align=="right"?S+=" pq-align-right":g.align=="center"&&(S+=" pq-align-center"),m==l.freezeCols-1&&h&&(S+=" pq-last-freeze-col"),g.className&&(S=S+" "+g.className),b&&(S+=" pq-cell-select ui-state-highlight");var x="pq-col-indx='"+m+"'";a&&(x+=" pq-dataIndx='"+y+"'");var T="<td class='"+S+"' style='"+E+"' "+x+" >			"+this._renderCell(v)+"</td>";u.push(T)}for(var N=0;N<i.length;N++){var m=i[N],g=n[m],y=g.dataIndx;v.column=g,v.colIndx=m;var E="";E+="visibility:hidden;";var S=o;g.align=="right"?S+=" pq-align-right":g.align=="center"&&(S+=" pq-align-center");var x="pq-col-indx='"+m+"'";a&&(x+=" pq-dataIndx='"+y+"'");var T="<td class='"+S+"' style='"+E+"' "+x+">			"+this._renderCell(v)+"</td>";u.push(T)}return u.push("</tr>"),u};var r=function(e){this.that=e,this.options=e.options,this.selectedRows=[],this.isDirty=!1},i=r.prototype;i._addToData=function(e){var t=this.options.dataModel.location,n=t=="remote"?this.that.data:this.options.dataModel.data,r=t=="remote"?e.rowIndxPage:e.rowIndx,i=n[r];i.selectedRow=!0},i.setDirty=function(){this.selectedRows.length>0&&(this.isDirty=!0)},i.removeAll=function(e){this.isDirty&&this.refresh();var t=e.raiseEvent,n=this.that,r=e.offset==null?n.getRowIndxOffset():obj.offset,i=this.selectedRows.slice(0);for(var s=0;s<i.length;s++){var o=i[s],u=o.rowIndx;this.remove({rowIndx:u,offset:r})}},i.refresh=function(){this.selectedRows=[];var e=this.options.dataModel.data;if(!e)return;for(var t=0,n=e.length;t<n;t++){var r=e[t];r.selectedRow&&this.selectedRows.push({rowIndx:t})}this.isDirty=!1},i.replace=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=e.offset=e.offset==null?this.that.getRowIndxOffset():e.offset,r=e.rowIndxPage=t-n,i=e.$tr,s=e.evt;this.removeAll({raiseEvent:!0}),this.add(e)},i.add=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=this.that,r=e.offset==null?n.getRowIndxOffset():e.offset,i=e.rowIndxPage=t-r,s=e.$tr,o=e.evt,u=this.selectedRows,a=this.isSelected(e);if(a==null)return!1;if(this.isSelected(e)==0){var f=this._boundRow(e),s=f;u.push({rowIndx:t}),this._addToData(e),n._trigger("rowSelect",o,{rowIndx:t,rowIndxPage:i,data:n.data,dataModel:n.dataModel,$tr:s})}else{var l=this.indexOf(e),c=this.selectedRows.splice(l,1);this.selectedRows=this.selectedRows.concat(c)}},i.remove=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=this.that,r=e.offset==null?n.getRowIndxOffset():e.offset,i=e.rowIndxPage=t-r,s=e.evt,o=n.init+r-n.offsetRow,u=n["final"]+r-n.offsetRow;if(this.isSelected(e)){var a=n.getRow({rowIndxPage:i});a&&a.removeClass("pq-row-select ui-state-highlight"),n._trigger("rowUnSelect",s,{rowIndx:t,dataModel:n.dataModel,$tr:a}),this._removeFromData(e)}var f=this.indexOf(e);f!=-1&&this.selectedRows.splice(f,1)},i.indexOf=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=this.selectedRows;for(var r=0;r<n.length;r++)if(n[r].rowIndx==t)return r;return-1},i.isSelected=function(e){this.isDirty&&this.refresh();var t=this.options.dataModel.location,n=t=="remote"?this.that.data:this.options.dataModel.data,r=t=="remote"?e.rowIndxPage:e.rowIndx,i=n[r];return i?i.selectedRow==null?!1:i.selectedRow:null},i.getSelection=function(){return this.isDirty&&this.refresh(),this.selectedRows},i._removeFromData=function(e){var t=this.options.dataModel.location,n=t=="remote"?this.that.data:this.options.dataModel.data,r=t=="remote"?e.rowIndxPage:e.rowIndx,i=n[r];i.selectedRow=!1},i._boundRow=function(e){var t=e.rowIndxPage,n=e.rowIndx,r=this.that,i=e.$tr==null?r.getRow({rowIndxPage:t}):e.$tr;return i==null||i.length==0?!1:(i.addClass("pq-row-select ui-state-highlight"),i)};var s=function(e){this.options=e.options,this.that=e,this.selectedCells=[]},o=s.prototype;o._addToData=function(e){var t=this.options.dataModel.location,n=t=="remote"?this.that.data:this.options.dataModel.data,r=t=="remote"?e.rowIndxPage:e.rowIndx,i=n[r];i.selectedDataIndices||(i.selectedDataIndices={}),i.selectedDataIndices[e.dataIndx]=!0},o._removeFromData=function(e){var t=this.options.dataModel.location,n=t=="remote"?this.that.data:this.options.dataModel.data,r=t=="remote"?e.rowIndxPage:e.rowIndx,i=n[r];i&&i.selectedDataIndices&&(i.selectedDataIndices[e.dataIndx]=!1)},o.setDirty=function(){this.selectedCells.length>0&&(this.isDirty=!0)},o.removeAll=function(e){this.isDirty&&this.refresh();var t=e.raiseEvent,n=this.that,r=e.offset==null?n.getRowIndxOffset():obj.offset,i=this.selectedCells.slice(0);for(var s=0;s<i.length;s++){var o=i[s],u=o.rowIndx,a=o.dataIndx;this.remove({rowIndx:u,offset:r,dataIndx:a})}},o.isSelected=function(e){this.isDirty&&this.refresh();var t=this.options.dataModel.location,n=this.that,r=t=="remote"?n.data:this.options.dataModel.data,i=t=="remote"?e.rowIndxPage:e.rowIndx,s=e.dataIndx==null?n.colModel[e.colIndx].dataIndx:e.dataIndx,o=r[i];return o==null?null:o.selectedDataIndices&&o.selectedDataIndices[s]?!0:!1},o.refresh=function(){this.selectedCells=[];var e=this.options.dataModel.data;if(!e)return;for(var t=0,n=e.length;t<n;t++){var r=e[t];r.selectedIndices&&r.selectedDataIndices[dataIndx]&&this.selectedCells.push({rowIndx:t,dataIndx:dataIndx})}this.isDirty=!1},o.replace=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=e.colIndx,r=e.offset=e.offset==null?this.that.getRowIndxOffset():e.offset,i=e.rowIndxPage=t-r,s=e.$td,o=e.evt;this.removeAll({raiseEvent:!0}),this.add(e)},o.add=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=this.that,r=e.offset==null?n.getRowIndxOffset():e.offset,i=e.rowIndxPage=t-r,s=e.colIndx=e.colIndx==null?n.getColIndxFromDataIndx(e.dataIndx):e.colIndx,o=e.dataIndx=e.dataIndx==null?n.colModel[s].dataIndx:e.dataIndx,u=e.evt,a=this.selectedCells,f=this.isSelected(e);if(f==null)return!1;if(f==0){var l=n.getCell({rowIndxPage:i,colIndx:s});l&&l.addClass("pq-cell-select ui-state-highlight"),a.push({rowIndx:t,dataIndx:o}),this._addToData(e),n._trigger("cellSelect",u,{rowIndx:t,rowIndxPage:i,colIndx:s,dataIndx:o,data:n.data,dataModel:n.dataModel,$td:l})}else{var c=this.indexOf(e),h=this.selectedCells.splice(c,1);this.selectedCells=this.selectedCells.concat(h)}},o.remove=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=this.that,r=e.dataIndx==null?n.colModel[e.colIndx].dataIndx:e.dataIndx,i=e.colIndx==null?n.getColIndxFromDataIndx(r):e.colIndx,s=e.offset==null?n.getRowIndxOffset():e.offset,o=e.rowIndxPage=t-s,u=e.evt,a=n.init+s,f=n["final"]+s;if(this.isSelected(e)){var l=n.getCell({rowIndxPage:o,colIndx:i});l&&l.removeClass("pq-cell-select ui-state-highlight"),n._trigger("cellUnSelect",u,{rowIndx:t,colIndx:i,dataIndx:r,dataModel:n.dataModel,$td:l}),this._removeFromData(e)}var c=this.indexOf(e);c!=-1&&this.selectedCells.splice(c,1)},o.indexOf=function(e){this.isDirty&&this.refresh();var t=e.rowIndx,n=this.that,r=e.dataIndx=e.dataIndx==null?n.colModel[e.colIndx].dataIndx:e.dataIndx,i=this.selectedCells;for(var s=0;s<i.length;s++){var o=i[s];if(o.rowIndx==t&&o.dataIndx==r)return s}return-1},o.getSelection=function(){return this.isDirty&&this.refresh(),this.selectedCells};var u={};u.options={bottomVisible:!0,colModel:null,columnBorders:!0,customData:null,dataModel:{cache:!1,curPage:0,totalPages:0,rPP:10,location:"local",sorting:"local",sortDir:"up",method:"GET",rPPOptions:[10,20,50,100]},direction:"",draggable:!1,editable:!0,editModel:{clicksToEdit:1,saveKey:""},flexHeight:!1,flexWidth:!1,freezeCols:0,getDataIndicesFromColIndices:!0,height:400,hoverMode:"row",minWidth:50,numberCell:!0,numberCellWidth:50,oddRowsHighlight:!0,resizable:!1,roundCorners:!0,rowBorders:!0,scrollModel:{pace:"fast",horizontal:!0},selectionModel:{type:"row",mode:"range"},sortable:!0,title:"&nbsp;",topVisible:!0,treeViewModel:null,width:600,wrap:!0},u._regional={strLoading:"Loading",strAdd:"Add",strEdit:"Edit",strDelete:"Delete",strSearch:"Search",strNothingFound:"Nothing found",strSelectedmatches:"Selected {0} of {1} match(es)",strPrevResult:"Previous Result",strNextResult:"Next Result"},e.extend(u.options,u._regional),u._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")},u._destroyDraggable=function(){this.element.data("draggable")&&this.element.draggable("destroy")},u._disable=function(){this.$disable==null&&(this.$disable=e("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},u._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},u._destroy=function(){this._destroyResizable(),this._destroyDraggable(),this.element.empty(),this.element.css("height",""),this.element.css("width",""),this.element.removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},u._findCellFromEvtCoords=function(t){if(this.$tbl==null)return{$td:null,rowIndxPage:null,colIndx:null};var n=t.pageY-this.$cont.offset().top,r=t.pageX-this.$cont.offset().left,i=this.$tbl.find("tr"),s=0,o=0,u=0;for(var a=1;a<i.length;a++){if(i[a].offsetTop>n)break;s++}var f=e(i[s]);o=parseInt(f.attr("pq-row-indx"));var l=f.find("td");s=0;for(var a=1;a<l.length;a++){if(l[a].offsetLeft>r)break;s++}var c=e(l[s]);return c[0].nodeName.toUpperCase()!="TD"&&(c=e(t.target).parent("td")),u=parseInt(c.attr("pq-col-indx")),{$td:c,rowIndxPage:o,colIndx:u}},u._rangeSelectRow=function(e,t,n){var r=this,i=r.sRows.getSelection(),s=i.slice(0);for(var o=0;o<s.length;o++){var u=s[o],a=u.rowIndx;(a<e||a>t)&&r.sRows.remove({rowIndx:a})}for(var a=e;a<=t;a++)r.sRows.add({rowIndx:rowIndx})},u._rangeSelect=function(e,t,n,r,i){var s=this,o=s.sCells.getSelection(),u=o.slice(0);for(var a=0;a<u.length;a++){var f=u[a],l=f.rowIndx,c=f.dataIndx,h=this.getColIndxFromDataIndx(c);l<e||l>n?s.sCells.remove({rowIndx:l,colIndx:h,dataIndx:c}):l==e&&h<t?s.sCells.remove({rowIndx:l,colIndx:h,dataIndx:c}):l==n&&h>r&&s.sCells.remove({rowIndx:l,colIndx:h,dataIndx:c})}for(var h=0;h<s.colModel.length;h++){var p=s.colModel[h];if(p.hidden)continue;var c=p.dataIndx,l=e;do{if(!(l==e&&h<t)){if(l==n&&h>r)break;s.sCells.add({rowIndx:l,colIndx:h,dataIndx:c})}l++}while(l<=n)}},u._blockSelect=function(e,t,n,r,i){var s=this,o=s.sCells.getSelection(),u=o.slice(0);for(var a=0;a<u.length;a++){var f=u[a],l=f.rowIndx,c=f.dataIndx,h=this.getColIndxFromDataIndx(c);h<t||h>r?s.sCells.remove({rowIndx:l,dataIndx:c,colIndx:h}):(l<e||l>n)&&s.sCells.remove({rowIndx:l,dataIndx:c,colIndx:h})}for(var h=t;h<=r;h++){var p=s.colModel[h],c=p.dataIndx;if(p.hidden)continue;var l=e;do s.sCells.add({rowIndx:l,colIndx:h,dataIndx:c}),l++;while(l<=n)}},u._create=function(){this.cTable=new t(this),this.minWidth=this.options.minWidth,this.cols=[],this.dataModel=this.options.dataModel,this.widths=[],this.outerWidths=[],this.rowHeight=22,this.hidearr=[],this.hidearrHS=[],this.numberCell=this.options.numberCell,this.numberCellWidth=this.options.numberCellWidth,this.freezeCols=this.options.freezeCols,this.tables=[];var n=this;this.$tbl=null,this._refreshHeader(),this._refreshWidths(),this._computeOuterWidths(),this.element.empty().addClass("pq-grid ui-widget ui-widget-content"+(this.options.roundCorners?" ui-corner-all":"")).append("<div class='pq-grid-top ui-widget-header"+(this.options.roundCorners?" ui-corner-top":"")+"'>		<div class='pq-grid-title'>&nbsp;</div></div>	<div class='pq-grid-inner' tabindex='0'><div class='pq-grid-right'> 		<div class='pq-header-outer ui-widget-header'>			<span class='pq-grid-header ui-state-default'></span><span class='pq-grid-header ui-state-default'></span>		</div>		<div class='pq-cont-right' >		<div class='pq-cont' ></div>		</div> 		</div></div>	<div class='pq-grid-bottom"+(this.options.roundCorners?" ui-corner-bottom":"")+"'>	<div class='pq-grid-footer'>&nbsp;</div>	</div>"),this.options.direction=="rtl"&&this.element.addClass("pq-rtl"),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),this.$top=e("div.pq-grid-top",this.element),this.$title=e("div.pq-grid-title",this.element),this.$toolbar=e("div.pq-grid-toolbar",this.element),this.$grid_inner=e("div.pq-grid-inner",this.element),this.$grid_right=e(".pq-grid-right",this.element),this.$header_o=e("div.pq-header-outer",this.$grid_right),this.options.topVisible||this.$top.css("display","none"),this.$header=e(".pq-grid-header",this.$grid_right),this.$header_left=e(this.$header[0]),this.$header_right=e(this.$header[1]),this.$bottom=e("div.pq-grid-bottom",this.element),this.options.bottomVisible||this.$bottom.css("display","none"),this.$footer=e("div.pq-grid-footer",this.element),this.$cont_o=e("div.pq-cont-right",this.$grid_right),this.$cont_fixed=e("div.pq-cont-fixed",this.$grid_right),this.$cont=e("div.pq-cont",this.$grid_right),this.$cont.on("click",function(e){return n._onClickCont(e)}),this.$cont.on("click",".pq-tree-expand-icon",function(e){return n.cTreeView._onClickTreeExpandIcon(e)}),this.$cont.on("click","td.pq-grid-cell",function(e){return n._onClickCell(e)}),this.$cont.on("click","tr.pq-grid-row",function(e){return n._onClickRow(e)}),this.$cont.on("dblclick","td.pq-grid-cell",function(e){return n._onDblClickCell(e)}),this.$cont.on("dblclick","tr.pq-grid-row",function(e){return n._onDblClickRow(e)}),this.$cont.on("mouseenter","td.pq-grid-cell",function(t){var r=e(this);if(n._trigger("cellMouseEnter",t,{$td:r,dataModel:n.options.dataModel})==0)return!1;n.options.hoverMode=="cell"&&n.highlightCell(r)}),this.$cont.on("mouseenter","tr.pq-grid-row",function(t){var r=e(this);if(n._trigger("rowMouseEnter",t,{$tr:r,dataModel:n.options.dataModel})==0)return!1;n.options.hoverMode=="row"&&n.highlightRow(r)}),this.$cont.on("mouseleave","td.pq-grid-cell",function(t){var r=e(this);if(n._trigger("cellMouseLeave",t,{$td:r,dataModel:n.options.dataModel})==0)return!1;n.options.hoverMode=="cell"&&n.unHighlightCell(r)}),this.$cont.on("mouseleave","tr.pq-grid-row",function(t){var r=e(this);if(n._trigger("rowMouseLeave",t,{$tr:r,dataModel:n.options.dataModel})==0)return!1;n.options.hoverMode=="row"&&n.unHighlightRow(r)}),this.$cont.bind("mousewheel DOMMouseScroll",function(e){return n._onMouseWheel(e)});var r=0;this.$hvscroll=e("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner),this.$vscroll=e("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner),this.prevVScroll=0,this.$vscroll.pqScrollBar({pace:n.options.scrollModel.pace,direction:"vertical",cur_pos:0,scroll:function(t,r){n.scrollMode=!0,n.selectCellRowCallback(function(){n.cTable._generateTables()}),e.measureTime(function(){var e;t.originalEvent&&t.originalEvent.type=="drag"?e=n._setScrollVNumEles():e=n._setScrollVNumEles(!0),e<=1&&n._setScrollHLength()},"scrollBar setNumEles stuff")}});var i=0;this.$hscroll=e("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner),this.$hscroll.pqScrollBar({direction:"horizontal",pace:n.options.scrollModel.pace,cur_pos:0,scroll:function(e,t){n._bufferObj_calcInitFinalH(),n._refreshHideArrHS(),n.scrollMode=!0,n.selectCellRowCallback(function(){n._createHeader(),n._refreshHeaderSortIcons(),n.cTable._generateTables(),n._refreshOtherTables()})}}),this.element.width(this.options.width).height(this.options.height),this.element.width(this.element.width()),this.disableSelection(),window.opera?this.$grid_inner.bind("keypress.pq-grid",{that:this},function(e){n.keyPressDown(e)}):this.$grid_inner.bind("keydown.pq-grid",{that:this},function(e){n.keyPressDown(e)}),this._refreshOptions(),this._refreshTitle();var s=this.options.dataModel;if(s.sortIndx!=null&&s.sorting=="local"&&s.location=="local"){this._refreshDataIndices();var o=this.getColIndxFromDataIndx(s.sortIndx);this._sortLocalData(s.sortIndx,s.sortDir,this.colModel[o].dataType,s.data)}this._initData(),this._createSelectedRowsObject(),this._createSelectedCellsObject(),this._refresh()},u._onMouseWheel=function(e){var t=this,n=0,e=e.originalEvent;e.wheelDelta?n=e.wheelDelta/120:e.detail&&(n=e.detail*-1/3);var r=parseInt(t.$vscroll.pqScrollBar("option","cur_pos")),i=r-n;return i>=0&&t.$vscroll.pqScrollBar("option","cur_pos",r-n).pqScrollBar("scroll"),!1},u._onDblClickCell=function(t){var n=this,r=e(t.currentTarget),i=n.getCellIndices(r),s=i.rowIndxPage,o=n.getRowIndxOffset(),u=s+o,a=i.colIndx;if(n._trigger("cellDblClick",t,{$td:r,dataModel:n.options.dataModel,rowIndxPage:s,rowIndx:u,colIndx:a})==0)return!1;this.isEditableCell({colIndx:a})&&n.options.editModel.clicksToEdit>1&&(n._setSelection(null),n.options.selectionModel.type=="cell"?n._setSelection({rowIndx:u,colIndx:a}):n.options.selectionModel.type=="row"&&n._setSelection({rowIndx:u}),n._editCell(r))},u._onClickCont=function(e){var t=this;t.$td_edit&&(t._isEditCell(e)||t.quitEditMode(e))},u._onClickRow=function(t){var n=this,r=e(t.currentTarget),i=parseInt(r.attr("pq-row-indx")),s=n.getRowIndxOffset(),o=i+s,u={rowIndx:o,evt:t};if(n._trigger("rowClick",t,{$tr:r,rowIndxPage:i,rowIndx:o,dataModel:n.options.dataModel})==0)return!1;var a=n.options.selectionModel;if(a.type=="row"){var f=n.sRows.getSelection();if(f.length>0
)if(t.ctrlKey&&a.mode!="single")n.sRows.indexOf(u)!=-1?n.sRows.remove(u):n._setSelection(u);else if(t.shiftKey&&a.mode!="single"){var l=f[f.length-1],c=l.rowIndx,h=c,p=o;c>o&&(h=o,p=c);var d=f.slice(0);for(var v=0;v<d.length;v++){var m=d[v],g=m.rowIndx;(g<h||g>p)&&n.sRows.remove({rowIndx:g,evt:t})}for(var g=h;g<=p;g++)n.sRows.add({rowIndx:g,evt:t});n._setSelection(u)}else n.sRows.removeAll({raiseEvent:!0}),n._setSelection(u);else n._setSelection(u)}},u._onDblClickRow=function(t){var n=this,r=e(t.currentTarget),i=parseInt(r.attr("pq-row-indx")),s=n.getRowIndxOffset(),o=i+s,u={rowIndx:o,evt:t};if(n._trigger("rowDblClick",t,{$tr:r,rowIndxPage:i,rowIndx:o,dataModel:n.options.dataModel})==0)return!1},u.isEditableCell=function(e){var t=e.colIndx,n=e.column==null?this.colModel[t]:e.column,r=!0;return this.options.editable==0&&(r=!1),n.editable==0&&(r=!1),r},u._getRowPQData=function(e,t,n){var n=n==null?this.data[e]:n;return n?n[t]:null},u._setRowPQData=function(e,t,n){var n=n==null?this.data[e]:n;if(!n)return;for(var r in t)n[r]=t[r]},u._onClickCell=function(t){var n=this,r=this.options,i=r.selectionModel,s=e(t.currentTarget),o=n.getCellIndices(s),u=o.rowIndxPage,a=n.getRowIndxOffset(),f=o.rowIndx=u+a,l=o.colIndx,c=o.dataIndx=this.colModel[l].dataIndx,h=n.colModel[l];o.evt=t;if(n._trigger("cellClick",t,{$td:s,rowIndxPage:u,rowIndx:f,colIndx:l,dataIndx:c,column:h,dataModel:n.options.dataModel})==0)return!1;n.$td_edit&&n.quitEditMode(t);if(this.isEditableCell({column:h})&&r.editModel.clicksToEdit=="1"){n._setSelection(null),i.type=="cell"?n._setSelection(o):(n.bringRowIntoView({rowIndxPage:u}),s=n._bringCellIntoView({rowIndxPage:u,colIndx:l})),window.setTimeout(function(){n.editCell(o)},0);return}if(i.type=="cell"){var p=n.sCells.getSelection();if(p.length>0)if(t.ctrlKey&&i.mode!="single")n.sCells.isSelected(o)?n.sCells.remove(o):n._setSelection(o);else if(t.shiftKey&&i.mode!="single"){var d=p[p.length-1],v=d.rowIndx,m=n.getColIndxFromDataIndx(d.dataIndx),g=v,y=f,b=m,w=l;v>f&&(g=f,y=v),n.options.selectionModel.mode=="range"?(v>f&&(b=l,w=m),f==v&&l<m&&(b=l,w=m),n._rangeSelect(g,b,y,w,t)):n.options.selectionModel.mode=="block"&&(m>l&&(b=l,w=m),n._blockSelect(g,b,y,w,t)),n._setSelection(o)}else n.sCells.removeAll({raiseEvent:!0}),n._setSelection(o);else n._setSelection(o)}},u.highlightCell=function(e){e.addClass("pq-grid-cell-hover ui-state-hover")},u.unHighlightCell=function(e){e.removeClass("pq-grid-cell-hover ui-state-hover")},u.highlightRow=function(e){e.addClass("pq-grid-row-hover ui-state-hover")},u.unHighlightRow=function(e){e.removeClass("pq-grid-row-hover ui-state-hover")},u._createSelectedRowsObject=function(){this.sRows=new r(this)},u._createSelectedCellsObject=function(){this.sCells=new s(this)},u._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.data,colModel:this.options.colModel}},u._refreshOptions=function(){this._refreshDataOptions()},u._refreshDataOptions=function(){},u.enableSelection=function(){this.$grid_inner.enableSelection()},u.disableSelection=function(){this.$grid_inner.disableSelection()},u._isEditCell=function(t){var n=e(t.target),r=n.closest("div.pq-cell-selected-border-edit");return r&&r.length>0?!0:!1},u._findCellFromEvt=function(t){var n=e(t.target),r=n.closest(".pq-grid-cell");if(r==null||r.length==0)return{rowIndxPage:null,colIndx:null,$td:null};var i=this.getCellIndices(r);return i.$td=r,i},u._initPager=function(){var e=this.options.dataModel,t=this,n={rPP:e.rPP,rPPOptions:e.rPPOptions,change:function(e,n){var r=t.options.dataModel;n.curPage!=undefined&&(r.prevPage=r.curPage,r.curPage=n.curPage),n.rPP!=undefined&&(r.rPP=n.rPP),r.paging=="remote"?t.remoteRequest():(t.$td_edit=null,t._refreshDataFromDataModel(),t._refresh())},refresh:function(e){t.refreshDataAndView()}};e.paging&&this.$footer.pqPager(n)},u._initData=function(){var e=this,t=this.options.dataModel;if(t==undefined)throw"dataModel not found.";this._initPager();if(t.location=="remote"){var e=this;this.generateLoading(),this.remoteRequest()}else this._refreshDataFromDataModel()},u._refreshHideArrHS=function(){var e=this;for(var t=0;t<e.colModel.length;t++)e.hidearrHS[t]=!1;if(e.initH>0){var n=e.freezeCols-1+e.initH;for(var t=e.freezeCols;t<=n;t++){if(e.colModel[t].hidden)continue;e.hidearrHS[t]=!0}}},u.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=e("<div class='pq-loading'></div>").appendTo(this.element),e("<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>"+this.options.strLoading+"...</div></div>").appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},u.showLoading=function(){this.element.find("div.pq-loading").show()},u.hideLoading=function(){this.element.find("div.pq-loading").hide()},u._refreshDataFromDataModel=function(){var e=this.options,t=e.dataModel;if(t.data==null||t.data.length==0){t.paging&&(t.curPage=0,t.totalPages=0,t.totalRecords=0);return}if(t.paging&&t.paging=="local"){t.totalRecords=t.data.length,t.totalPages=Math.ceil(t.data.length/t.rPP),t.curPage>t.totalPages&&(t.curPage=t.totalPages),t.curPage<1&&t.totalPages>0&&(t.curPage=1);var n=(t.curPage-1)*t.rPP,r=t.curPage*t.rPP;r>t.data.length&&(r=t.data.length),this.data=t.data.slice(n,r)}else this.data=t.data},u.remoteRequest=function(t){this.loading&&this.xhr.abort();var n=this,r="",i="",s=this.options.dataModel;if(typeof s.getUrl=="function"){var o=s.getUrl();o&&o.url&&(r=o.url),o&&o.data&&(i=o.data)}if(!r)return;this.loading=!0,this.showLoading(),this.xhr=e.ajax({url:r,dataType:s.dataType,async:!0,cache:s.cache,type:s.method,data:i,beforeSend:function(e,t){if(typeof s.beforeSend=="function")return s.beforeSend(e,t)},success:function(e,r,i){var o=!1;if(typeof s.getData!="function")throw"getData callback not found!";var u=s.getData(e,r,i);s.data=u.data,s.paging&&s.paging=="remote"&&(u.curPage&&(s.curPage=u.curPage),u.totalRecords&&(s.totalRecords=u.totalRecords,s.totalPages=Math.ceil(s.totalRecords/s.rPP))),n._refreshDataFromDataModel(),s.sorting=="local"&&s.sortIndx!=undefined?n._refreshSortingDataAndView({sorting:!0}):n._refreshViewAfterDataSort(),n.hideLoading(),n.loading=!1,n._trigger("load",null,{dataModel:n.options.dataModel,data:n.data}),typeof t=="function"&&t()},error:function(e,t,r){n.hideLoading(),n.loading=!1,typeof s.error=="function"&&s.error(e,t,r)}})},u._fixFireFoxContentEditableIssue=function(){window.postMessage&&this.$grid_inner.focus()},u.selectCellRowCallback=function(t){var n,r;this.$td_edit&&this.quitEditMode();var i=this;e.measureTime(function(){t.call(i)},"_generateTables"),this.options.flexHeight&&this.setGridHeightFromTable(),this.options.flexWidth&&this._setGridWidthFromTable()},u._refreshTitle=function(){this.$title.html(this.options.title)},u._refreshDraggable=function(){this.options.draggable?(this.$title.addClass("draggable"),this.element.draggable({handle:this.$title,start:function(e,t){}})):this._destroyDraggable()},u._refreshResizable=function(){var t=this;this.options.resizable?this.element.resizable({helper:"ui-state-highlight",delay:0,start:function(t,n){e(n.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(e,t){},stop:function(e,n){t.options.height=t.element.height(),t.options.width=t.element.width(),t._refresh(),t.element.css("position","relative")}}):this._destroyResizable()},u.refresh=function(){this._refresh()},u._refreshDataIndices=function(){if(this.options.getDataIndicesFromColIndices==0)return;var e=this.colModel;for(var t=0;t<e.length;t++){var n=e[t];n.dataIndx==null&&(n.dataIndx=t)}},u._refresh=function(){var e=this;this._refreshDataIndices(),this._refreshResizable(),this._refreshDraggable(),this._setScrollHNumEles(),this._bufferObj_calcInitFinalH(),this._refreshHideArrHS(),this._computeOuterWidths(!0),this._createHeader(),this._refreshHeaderSortIcons(),this._setInnerGridHeight(),this._setRightGridHeight(),this.selectCellRowCallback(function(){e.cTable._generateTables(),e._computeOuterWidths()}),this._setScrollHLength(),this._setScrollVLength(),this._setScrollVNumEles(!0),this._setScrollHLength(),this._refreshPager()},u._refreshPager=function(){var e=this.options.dataModel;e.paging&&this.$footer.pqPager("option",{currentPage:e.curPage,totalPages:e.totalPages,totalRecords:e.totalRecords,rPP:e.rPP,rPPOptions:e.rPPOptions})},u._refreshViewAfterDataSort=function(){this.selectCellRowCallback(function(){this.cTable._generateTables(),this._computeOuterWidths()}),this._refreshHeaderSortIcons(),this._setRightGridHeight(),this._setScrollVLength(),this._setScrollVNumEles(!0),this._setScrollHLength(),this._refreshPager()},u.refreshSortingDataAndView=function(){this._refreshSortingDataAndView({sorting:!0})},u.refreshDataAndView=function(e){this.data=null,this.sRows.setDirty(),this.sCells.setDirty();var t=this.options.dataModel;t.location=="remote"?(t.data=null,this.remoteRequest()):this._refreshSortingDataAndView({keepSelection:e,sorting:!0})},u.getColIndxFromDataIndx=function(e){var t=this.colModel;for(var n=0;n<t.length;n++)if(t[n].dataIndx==e)return n},u._refreshSortingDataAndView=function(e){var t=e.sorting,n=e.fn,r=e.keepSelection;r||(this.sRows.removeAll({raiseEvent:!0}),this.sCells.removeAll({raiseEvent:!0}));var i=this.options.dataModel,s=this.colModel,o=i.sortIndx,u=this.getColIndxFromDataIndx(o);if(o==null||u==null)t=!1;var a=i.sortDir,f=this;if(t==1)if(i.sorting=="remote")this.remoteRequest(n);else{var l=s[u],c=l.dataType;this._sortLocalData(o,a,c,i.data),this.sRows.setDirty(),this.sCells.setDirty(),this._refreshDataFromDataModel(),f._refreshViewAfterDataSort(),typeof n=="function"&&n()}else i.location=="remote"?this.remoteRequest(n):(this.data==null&&this._refreshDataFromDataModel(),f._refreshViewAfterDataSort(),typeof n=="function"&&n())},u._computeOuterWidths=function(e){var t=this.options,n=t.columnBorders,r=this.colModel,i=r.length;for(var s=0;s<i;s++){var o=r[s];this.outerWidths[s]=parseInt(o.width)+(n?1:0)}this.numberCell_outerWidth=this.numberCellWidth+1;return},u._setOption=function(t,n){this.refreshRequired=!0;if(t=="height")this.element.height(n),e.Widget.prototype._setOption.call(this,t,n);else if(t=="width")this.element.width(n),e.Widget.prototype._setOption.call(this,t,n);else if(t=="title")e.Widget.prototype._setOption.call(this,t,n),this._refreshTitle();else if(t=="roundCorners")n?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom")),this.refreshRequired=!1;else if(t=="freezeCols")!isNaN(n)&&n>=0&&parseInt(n)<=this.colModel.length-2&&(this.options.freezeCols=this.freezeCols=parseInt(n),this._setScrollHLength(),e.Widget.prototype._setOption.call(this,t,n));else if(t=="resizable")e.Widget.prototype._setOption.call(this,t,n);else if(t=="scrollModel"){var r=n;for(var t in r)this.options.scrollModel[t]=r[t]}else if(t=="dataModel"){e.Widget.prototype._setOption.call(this,t,n);var i=n.paging;this.$footer.hasClass("pq-pager")!=0||i!="local"&&i!="remote"?this.$footer.hasClass("pq-pager")&&i!="local"&&i!="remote"&&(this.$footer.pqPager("destroy"),this.$footer.html("&nbsp;")):this._initPager(),this.refreshDataAndView()}else if(t=="selectionModel"){var r=n;for(var t in r)this.options.selectionModel[t]=r[t];this.refreshRequired=!1}else t=="colModel"?(e.Widget.prototype._setOption.call(this,t,n),this._refreshHeader(),this._refreshWidths(),this._refreshDataIndices()):t=="disabled"?(n==1?this._disable():this._enable(),this.refreshRequired=!1):t=="numberCell"?(this.numberCell=n,e.Widget.prototype._setOption.call(this,t,n)):t=="numberCellWidth"?(this.numberCellWidth=n,e.Widget.prototype._setOption.call(this,t,n)):t=="customData"?(e.Widget.prototype._setOption.call(this,t,n),this.refreshRequired=!1):t=="strLoading"?(e.Widget.prototype._setOption.call(this,t,n),this.generateLoading(),this.refreshRequired=!1):t=="topVisible"?n==1?this.$top.css("display",""):this.$top.css("display","none"):t=="bottomVisible"?n==1?this.$bottom.css("display",""):this.$bottom.css("display","none"):e.Widget.prototype._setOption.call(this,t,n)},u._setOptions=function(){e.Widget.prototype._setOptions.apply(this,arguments),this.refreshRequired&&this._refresh(),this.refreshRequired=!0},u._generateCellRowOutline=function(t){var n=t.$td,r=t.$tr,i=this;if(r){var s=i._calcRightEdgeCol(i.colModel.length-1);s-=4;var o=r[0].offsetHeight-4,u=e(r[0].offsetParent),a=u[0].offsetParent,f=r[0].offsetLeft+u[0].offsetLeft,l=r[0].offsetTop+u[0].offsetTop;i._generateCellHighlighter(a,f,l,s,o)}else if(n){var u=e(n[0].offsetParent),a=u[0].offsetParent,s=n[0].offsetWidth-4,o=n[0].offsetHeight-4,f=n[0].offsetLeft+u[0].offsetLeft,l=n[0].offsetTop+u[0].offsetTop;i._generateCellHighlighter(a,f,l,s,o)}},u._removeCellRowOutline=function(){this.$div_focus&&(this._fixFireFoxContentEditableIssue(),this.$div_focus.remove(),this.$div_focus=null)},u._generateCellHighlighter=function(t,n,r,i,s){this.$div_focus&&this.$div_focus[0].offsetParent==t?(this.$td_edit!=null&&(this._fixFireFoxContentEditableIssue(),this.$div_focus.empty().removeClass("pq-cell-selected-border-edit"),this.$td_edit=null),this.$div_focus.css({left:n,top:r,height:s,width:i})):(this.$div_focus&&this.$div_focus.remove(),this.$div_focus=e("<div class='pq-cell-selected-border'></div>").appendTo(t),this.$div_focus.css({left:n,top:r,height:s,width:i}))},u._selectRow=function(e,t){this.selectRow(e,t)},u._findfirstUnhiddenColIndx=function(){for(var e=0;e<this.colModel.length;e++)if(!this.colModel[e].hidden)return e},u.selectRow=function(e){var t=e.rowIndx,n=e.evt,r=e.offset;if(!n||n.type!="keydown"&&n.type!="keypress"){if(this.sRows.add(e)==0)return!1}else if(this.sRows.replace(e)==0)return!1;return n!=null&&this._setGridFocus(),!0},u.scrollY=function(e){this.$vscroll.pqScrollBar("option","cur_pos",e).pqScrollBar("scroll")},u.bringRowIntoView=function(e){var t=e.rowIndxPage,n=this.init-this.offsetRow,r=this._calcCurPosFromRowIndxPage(t);r<this.scrollCurPos&&this.$vscroll.pqScrollBar("option","cur_pos",r).pqScrollBar("scroll");var i=this.$tbl.find("tr[pq-row-indx="+t+"]");if(i[0]==undefined)this.$vscroll.pqScrollBar("option","cur_pos",r).pqScrollBar("scroll");else{var s=i[0].offsetTop+i[0].offsetHeight,o=this.$cont[0].offsetHeight,u=this._getScollBarHorizontalHeight();if(s>o-u){var a=s-(o-u),f=this.$tbl.children().children("tr"),l=0,c=0;f.each(function(e,t){l+=t.offsetHeight;if(l>=a)return c=e,!1});var h=this.scrollCurPos+c,p=this.$vscroll.pqScrollBar("option","num_eles");p<h+1&&(p=h+1),this.$vscroll.pqScrollBar("option",{num_eles:p,cur_pos:h}).pqScrollBar("scroll")}}},u._bringCellIntoView=function(e){var t=e.rowIndxPage,n=e.colIndx,r=!1,i;if(this.hidearrHS[n]){this.hidearrHS[n]=!1;var s=n-this.freezeCols-this._calcNumHiddenUnFrozens(n);this.$hscroll.pqScrollBar("option","cur_pos",s).pqScrollBar("scroll"),r=!0}else{var i=this.$tbl.find("tr[pq-row-indx="+t+"]>td[pq-col-indx="+n+"]");if(i.length==0)return!1;var o=this._calcRightEdgeCol(n).width,u=17;if(this.$vscroll.css("visibility")=="hidden"||this.$vscroll.css("display")=="none")u=0;if(o>this.$cont[0].offsetWidth-u){var a=this._calcWidthCols(n)-(this.$cont[0].offsetWidth-u),f=i.parent("tr").children("td"),l=this.colModel.length,c=0,h=0;for(var p=this.freezeCols;p<l;p++){this.colModel[p].hidden||(c+=this.outerWidths[p]);if(p==n){h=p-this.freezeCols-this._calcNumHiddenUnFrozens(p);break}if(c>=a){h=p-this.freezeCols-this._calcNumHiddenUnFrozens(p)+1;break}}this.$hscroll.pqScrollBar("option","cur_pos",h).pqScrollBar("scroll"),r=!0}}if(r){var i=this.$tbl.find("tr[pq-row-indx="+t+"]>td[pq-col-indx="+n+"]");return i}return i},u.selection=function(e){var t=e.rowIndx,n=e.colIndx,r=e.method,i=e.type;if(i=="row")return this.sRows[r](e);if(i=="cell")return this.sCells[r](e);return},u.setSelection=function(e){if(e==null||e.rowIndx==null){this.sRows.removeAll({raiseEvent:!0}),this.sCells.removeAll({raiseEvent:!0});return}return this._bringPageIntoView(e),this._setSelection(e)},u._bringPageIntoView=function(e){var t=e.rowIndx,n=this,r=this.options.dataModel;if(r.paging=="local"&&t>=0){var i=r.curPage,s=r.rPP,o=(i-1)*s,u=i*s;t>=o&&t<u||(r.curPage=Math.ceil((t+1)/s),this._refreshDataFromDataModel(),this._refreshViewAfterDataSort())}},u._setSelection=function(e){if(e==null)return this.sRows.removeAll({raiseEvent:!0}),this.sCells.removeAll({raiseEvent:!0}),!1;var t=e.offset=e.offset==null?this.getRowIndxOffset():e.offset,n=e.rowIndx=e.rowIndx==null?e.rowIndxPage+t:e.rowIndx,r=e.rowIndxPage=e.rowIndxPage==null?e.rowIndx-t:e.rowIndxPage,i=e.colIndx,s=e.evt;return r<0||i<0?!1:this.data==null||this.data.length==0?!1:r>=this.data.length||i>=this.colModel.length?!1:(this.bringRowIntoView({rowIndxPage:r}),i==null?this.selectRow({rowIndx:n,evt:s}):(this._bringCellIntoView({rowIndxPage:r,colIndx:i}),this.selectCell({rowIndx:n,colIndx:i,evt:s})))},u.saveEditCell=function(){if(this.$td_edit==null)return;var e=this.$td_edit,t=this.getCellIndices(e),n=this.getRowIndxOffset(),r=t.colIndx,i=t.rowIndxPage,s=t.rowIndx=i+n,o=this.colModel,u=t.column=o[r],a=t.dataIndx=u.dataIndx,f=this.data[i][a];if(i!=null){var l=this._getEditCellData(t);if(l!=f){this.data[i][a]=l,t.data=this.data;if(this._trigger("cellSave",null,t)==0)return;this.refreshRow(t),this._fixTableViewPort();var c=this;c.options.flexHeight?(c.setGridHeightFromTable(),c._fixIEFooterIssue()):c.bringRowIntoView({rowIndxPage:i})}}},u._fixTableViewPort=function(){var e=this.$cont[0];e.scrollTop=0,e.scrollLeft=0},u._fixIEFooterIssue=function(){e(".pq-grid-footer").css({position:"absolute"}),e(".pq-grid-footer").css({position:"relative"})},u.refreshColumn=function(e){var t=this.options.customData,n=e.colIndx=e.colIndx==null?this.getColIndxFromDataIndx(e.dataIndx):e.colIndx,r=this.getRowIndxOffset();for(var i=this.init;i<=this["final"];i++){var s=e.rowIndxPage=i;e.rowIndx=s+r;var o=e.column=this.colModel[n];e.$td=this.getCell(e),e.rowData=this.data[s],e.customData=t,this.cTable._renderCell(e)}},u.refreshCell=function(e){if(!this.data)return;var t=e.offset=e.offset==null?this.getRowIndxOffset():e.offset,n=e.rowIndx=e.rowIndx==null?e.rowIndxPage+t:e.rowIndx,r=e.rowIndxPage=e.rowIndxPage==null?e.rowIndx-t:e.rowIndxPage,i=e.dataIndx,s=e.colIndx=e.colIndx==null?this.getColIndxFromDataIndx(i):e.colIndx,o=e.$td=e.$td==null?this.getCell(e):e.$td,u=e.column=this.colModel[s],a=this.data[r];if(!a)return;var f=e;f.rowData=a,f.customData=this.options.customData,o&&o.length>0&&this.cTable._renderCell(f)},u.refreshRow=function(e){if(!this.data)return;var t=this.options,n=e.offset=e.offset==null?this.getRowIndxOffset():e.offset,r=e.rowIndx=e.rowIndx==null?e.rowIndxPage+n:e.rowIndx,i=e.rowIndxPage=e.rowIndxPage==null?e.rowIndx-n:e.rowIndxPage,s=e.$tr==null?this.getRow(e):e.$tr,o=this.colModel,u=this.data[i];if(!u)return;var a={rowIndx:r,rowIndxPage:i,rowData:u,customData:t.customData};for(var f=0;f<o.length;f++){var l=o[f],c=s.find("td[pq-col-indx="+f+"]");a.$td=c,a.colIndx=f,a.column=l,c&&c.length>0&&this.cTable._renderCell(a)}},u.quitEditMode=function(e){if(this.$td_edit){var t=this.$td_edit;this.disableSelection(),this._setGridFocus(),this._trigger("quitEditMode",e,{$td:t,dataModel:this.options.dataModel}),this._removeCellRowOutline(),this.$td_edit=null}},u.getData=function(){return this.data},u.getViewPortRowsIndx=function(){return{beginIndx:this.init,endIndx:this["final"]}},u.getRowIndxOffset=function(){var e=this.options.dataModel,t=e.paging,n=0;if(t=="local"||t=="remote"){var r=e.curPage,i=e.rPP;n=i*(r-1)}return n},u.getRowOffset=function(){return this.offsetRow},u._cellblurred=function(){this.$div_focus.remove(),this.$div_focus=null,this.$td_focus=null,this.$tr_focus=null},u.selectCell=function(e){var t=e.rowIndx,n=e.colIndx,r=e.evt;if(!r||r.type!="keydown"&&r.type!="keypress"){if(this.sCells.add(e)==0)return!1}else if(this.sCells.replace(e)==0)return!1;return r!=null&&this._setGridFocus(),!0},u._setGridFocus=function(){var e=this;window.setTimeout(function(){e.$td_edit==null&&e.$grid_inner.focus()},0)},u.getEditCell=function(){return this.$td_edit?{$td:this.$td_edit,$cell:this.$div_focus}:null},u.editCell=function(e){var t=this.getCell(e);if(t!=null&&t.length==1)return this.$td_edit&&this.$td_edit[0]!=t[0]&&this.quitEditMode(),this._editCell(t),t},u.getFirstEditableColIndx=function(){if(!this.options.editable)return-1;var e=this.colModel;for(var t=0;t<e.length;t++){var n=e[t];if(n.editable==0)continue;return t}return-1},u._editFirstCellInRow=function(e){var t=this.getFirstEditableColIndx();if(t!=-1){var n=e.rowIndxPage;e.colIndx=t,this.bringRowIntoView(e);var r=this._bringCellIntoView(e);r&&r.length>0&&this._editCell(r)}},u._editCell=function(e){var t=this,n=t.getCellIndices(e),r=n.rowIndxPage,i=this.getRowIndxOffset(),s=r+i,o=n.colIndx,u=this.colModel[o],a=u.dataIndx;if(this.$td_edit&&this.$td_edit[0]==e[0])return!1;this.$td_edit=e,this.enableSelection(),this._removeCellRowOutline(),this._generateCellRowOutline({$td:e});var f=this.$div_focus.addClass("pq-cell-selected-border-edit");u.align=="right"?f.css("text-align","right"):u.align=="center"?f.css("text-align","center"):f.css("text-align","left");if(u.editor)u.editor({$cell:f,data:this.data,dataModel:this.dataModel,rowIndx:s,rowIndxPage:r,colIndx:a});else{f.html("<div contenteditable='true' tabindx='0' class='pq-grid-editor-default'></div>");var t=this;f.children().html(t.data[r][a])}var t=this;window.setTimeout(function(){if(t.$td_edit!=null){var e=t.$div_focus;e.children().focus()}},0)},u.getRow=function(e){var t=e.rowIndxPage,n;return this.$tbl!=undefined&&(n=this.$tbl.find("tr[pq-row-indx="+t+"]")),n},u.getCell=function(e){var t=e.rowIndxPage==null?e.rowIndx-this.getRowIndxOffset():e.rowIndxPage,n=e.colIndx,r;return this.$tbl!=undefined&&(r=this.$tbl.find("tr[pq-row-indx="+t+"]>td[pq-col-indx="+n+"]")),r},u.getEditCellData=function(){if(this.$td_edit){var e=this.getCellIndices(this.$td_edit);return this._getEditCellData(e)}return null},u._getEditCellData=function(e){var t=e.colIndx,n=e.rowIndxPage,r=e.rowIndx!=null?e.rowIndx:n+this.getRowIndxOffset(),i=e.column?e.column:this.colModel[t],s=e.$cell?e.$cell:this.$div_focus;if(i.getEditCellData)var o=i.getEditCellData({$cell:s,data:this.data,dataIndx:i.dataIndx,dataModel:this.dataModel,rowIndx:r,rowIndxPage:n,colIndx:t});else var o=s.children().html();return o},u.getCellIndices=function(e){if(e==null||e.length==0)return{rowIndxPage:null,colIndx:null};var t=e.parent("tr"),n=t.parent("tbody"),r=parseInt(t.attr("pq-row-indx")),i=parseInt(e.attr("pq-col-indx"));return{rowIndxPage:r,colIndx:i}},u._incrRowIndx=function(e,t){var n=e,t=t==null?1:t,r=0;for(var i=e+1,s=this.data.length;i<s;i++){var o=this._getRowPQData(i,"hidden");if(!o){r++,n=i;if(r==t)return n}}return n},u._decrRowIndx=function(e,t){var n=e,t=t==null?1:t,r=0;for(var i=e-1;i>=0;i--){var s=this._getRowPQData(i,"hidden");if(!s){r++,n=i;if(r==t)return n}}return n},u._incrIndx=function(e,t){var n=this;if(t==null)return e==this._getLastVisibleRowIndxPage(this.data)?null:(e=this._incrRowIndx(e),{rowIndxPage:e});var r;do{t++;if(t>=n.colModel.length){if(e==this._getLastVisibleRowIndxPage(this.data))return null;e=this._incrRowIndx(e),t=0}r=n.colModel[t]}while(r&&r.hidden);return{rowIndxPage:e,colIndx:t}},u._decrIndx=function(e,t){var n=this;if(t==null)return e==this._getFirstVisibleRowIndxPage(this.data)?null:(e=this._decrRowIndx(e),{rowIndxPage:e});var r;do{t--;if(t<0){if(e==this._getFirstVisibleRowIndxPage(this.data))return null;e=this._decrRowIndx(e),t=n.colModel.length-1}r=n.colModel[t]}while(r&&r.hidden);return{rowIndxPage:e,colIndx:t}},u._incrEditIndx=function(e,t){var n=this,r;do{t++;if(t>=n.colModel.length){if(e==this._getLastVisibleRowIndxPage(this.data))return null;e=this._incrRowIndx(e),t=0}r=n.colModel[t]}while(r&&(r.hidden||r.editable===!1));return{rowIndxPage:e,colIndx:t}},u._decrEditIndx=function(e,t){var n=this,r;do{t--;if(t<0){if(e==this._getFirstVisibleRowIndxPage(this.data))return null;e=this._decrRowIndx(e),t=n.colModel.length-1}r=n.colModel[t]}while(r&&(r.hidden||r.editable===!1));return{rowIndxPage:e,colIndx:t}},u.addColumn=function(e,t){var n=this.options,r=n.colModel,i=n.dataModel.data;r.push(e),this._refreshHeader();for(var s=0;s<i.length;s++){var o=i[s];o.push("")}},u.keyPressDown=function(t){var n=this,r=this.sCells.getSelection(),i=this.sRows.getSelection(),s=n.getRowIndxOffset(),o=n.options.selectionModel,u,a,f={left:37,up:38,right:39,down:40,tab:9,enter:13,pageDown:34,pageUp:33,spaceBar:32,esc:27,home:36,end:35};if(n.$td_edit){var l=e(n.$td_edit[0]),c=n.getCellIndices(l),h=c.rowIndxPage,u=h+s,a=c.colIndx,p=this.colModel[a],d=p.editModel?p.editModel.saveKey:null;if(n._trigger("cellEditKeyDown",t,{dataModel:this.dataModel,$cell:this.$div_focus,rowIndx:u,rowIndxPage:h,colIndx:a,$td:l,column:n.colModel[a]})==0)return!1;if(t.keyCode==f.tab){var c;t.shiftKey?c=n._decrEditIndx(h,a):c=n._incrEditIndx(h,a),n.saveEditCell();if(c==null)return t.preventDefault(),!1;n.quitEditMode(t),this.options.selectionModel.type=="row"?(c.rowIndxPage!=h&&(n._setSelection(null),n._setSelection({rowIndxPage:c.rowIndxPage})),n._bringCellIntoView({rowIndxPage:c.rowIndxPage,colIndx:c.colIndx})):(c.rowIndxPage!=h||c.colIndx!=a)&&this.options.selectionModel.type=="cell"&&(n._setSelection(null),n._setSelection({rowIndxPage:c.rowIndxPage,colIndx:c.colIndx})),h=c.rowIndxPage,a=c.colIndx;var v=this.getCell({rowIndxPage:c.rowIndxPage,colIndx:c.colIndx});return v&&v.length>0&&this._editCell(v),t.preventDefault(),!1}if(t.keyCode==d)n.saveEditCell(),n.quitEditMode(t);else if(d==null&&t.keyCode==this.options.editModel.saveKey)n.saveEditCell(),n.quitEditMode(t);else{if(t.keyCode==f.esc)return n.quitEditMode(t),t.preventDefault(),!1;if(t.keyCode==f.pageUp||t.keyCode==f.pageDown)return t.preventDefault(),!1}return}if(i.length>0&&o.type=="row")var c=i[i.length-1],u=c.rowIndx,h=u-s;else{if(!(r.length>0&&o.type=="cell"))return;var c=r[r.length-1],u=c.rowIndx,h=u-s,m=c.dataIndx,a=this.getColIndxFromDataIndx(m);if(u==null||a==null)return;n._trigger("cellKeyDown",t,{dataModel:this.dataModel,rowIndx:u,colIndx:a,$td:c.$td,column:n.colModel[a]});if(t.cancelBubble)return}if(t.keyCode==f.left){var c=n._decrIndx(h,a);c&&n._setSelection({rowIndxPage:c.rowIndxPage,colIndx:c.colIndx,evt:t}),t.preventDefault();return}if(t.keyCode==f.right){var c=n._incrIndx(h,a);c&&n._setSelection({rowIndxPage:c.rowIndxPage,colIndx:c.colIndx,evt:t}),t.preventDefault();return}if(t.keyCode==f.tab){var c;t.shiftKey?c=n._decrIndx(h,a):c=n._incrIndx(h,a),c&&n._setSelection({rowIndxPage:c.rowIndxPage,colIndx:c.colIndx,evt:t}),t.preventDefault();return}if(t.keyCode==f.up){h=n._decrRowIndx(h),c&&n._setSelection({rowIndxPage:h,colIndx:a,evt:t}),t.preventDefault();return}if(t.keyCode==f.down){h=n._incrRowIndx(h),c&&n._setSelection({rowIndxPage:h,colIndx:a,evt:t}),t.preventDefault();return}if(t.keyCode==f.pageDown||t.keyCode==f.spaceBar){var u=this._incrRowIndx(h,this.pageSize+1)+s;n._setSelection({rowIndx:u,colIndx:a,evt:t}),t.preventDefault();return}if(t.keyCode==f.pageUp){var u=this._decrRowIndx(h,this.pageSize+1)+s;n._setSelection({rowIndx:u,colIndx:a,evt:t}),t.preventDefault();return}if(t.keyCode==f.home){u=0+s,n._setSelection({rowIndx:u,colIndx:a,evt:t}),t.preventDefault();return}if(t.keyCode==f.end){u=n.data.length-1+s,n._setSelection({rowIndx:u,colIndx:a,evt:t}),t.preventDefault();return}if(t.keyCode==f.enter){if(this.options.selectionModel.type=="row"){var g,l;i.length>0&&n._editFirstCellInRow({rowIndxPage:h})}else if(r.length>0){var l=this.getCell({rowIndxPage:h,colIndx:a});l&&l.length>0&&this.isEditableCell({colIndx:a})&&n._editCell(l)}t.preventDefault();return}},u._calcNumHiddenFrozens=function(){var e=0;for(var t=0;t<this.freezeCols;t++)this.colModel[t].hidden&&e++;return e},u._calcNumHiddenUnFrozens=function(e){var t=0,n=e!=null?e:this.colModel.length;for(var r=this.freezeCols;r<n;r++)this.colModel[r].hidden&&t++;return t},u._setScrollHLength=function(){if(!this.options.scrollModel.horizontal){this.$hscroll.css("visibility","hidden"),this.$hvscroll.css("visibility","hidden");return}this.$hscroll.css("visibility",""),this.$hvscroll.css("visibility","");var e=this.$cont[0].offsetWidth;this.numberCell&&(e-=this.numberCell_outerWidth);var t=this.colModel;for(var n=0;n<this.freezeCols;n++){var r=t[n];r.hidden||(e-=this.outerWidths[n])}var i=this._getScollBarVerticalWidth();i==0?this.$hscroll.css("right",0):this.$hscroll.css("right",""),e-=i,this.$hscroll.pqScrollBar("option","length",e)},u._setScrollHNumEles=function(){var e=this.colModel.length-this.freezeCols-this._calcNumHiddenUnFrozens();this.$hscroll.pqScrollBar("option","num_eles",e)},u._getScollBarHorizontalHeight=function(){var e=13;if(this.$hscroll.css("visibility")=="hidden"||this.options.scrollModel.horizontal==0||this.$hscroll.css("display")=="none")e=0;return e},u._getScollBarVerticalWidth=function(){var e=13;if(this.$vscroll.css("visibility")=="hidden"||this.options.flexHeight||this.$vscroll.css("display")=="none")e=0;return e},u._setScrollVNumEles=function(e){var t=this,n=this.$vscroll,r=n.pqScrollBar("option"),i=parseInt(r.num_eles),s=parseInt(r.cur_pos),o=this._getScollBarHorizontalHeight(),u=this.data,a=u?this._getTotalVisibleRows(u):0,f=this.$cont[0].offsetHeight,l=this.$tbl?this.$tbl[0].offsetHeight:0;if(l>0&&l>f-o){var c=this.$tbl.children().children("tr"),h=0,p=0;c.each(function(e,t){h+=t.offsetHeight;if(h>=f-o)return p=e>1?e-1:0,!1}),i=a-p+1}else i=s+1;return i<s+1&&(i=s+1),e?t.$vscroll.pqScrollBar("option","num_eles",i):t.$vscroll.pqScrollBar("setNumEles",i),i},u._getFirstVisibleRowIndxPage=function(e){for(var t=0,n=e.length;t<n;t++){var r=this._getRowPQData(t,"hidden");if(!r)return t}},u._getLastVisibleRowIndxPage=function(e){for(var t=e.length-1;t>=0;t--){var n=this._getRowPQData(t,"hidden");if(!n)return t}},u._getTotalVisibleRows=function(e){if(this.options.treeViewModel){var t=0;for(var n=0,r=e.length;n<r;n++){var i=this._getRowPQData(n,"hidden");i||t++}return t}return e.length},u._setScrollVLength=function(){var e=this.$cont.height(),t=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",t);var n=e-t;this.$vscroll.pqScrollBar("option","length",n);return},u._setInnerGridHeight=function(){if(this.options.flexHeight)return;var e=this.element.height()-(this.options.topVisible?this.$top[0].offsetHeight:0)-(this.options.bottomVisible?this.$bottom[0].offsetHeight:0);this.$grid_inner.height(e+"px")},u._setRightGridHeight=function(){this.$header_o.height(this.$header_left.height()-2);if(this.options.flexHeight)return;this.$vscroll.css("visibility",""),this.$tbl&&this.$tbl.css("marginBottom",0);var e=this.element.height()-this.$header_o[0].offsetHeight-(this.options.topVisible?this.$top[0].offsetHeight:0)-(this.options.bottomVisible?this.$bottom[0].offsetHeight:0),t=0;this.$cont.height(e-t+"px")},u.setGridHeightFromTable=function(){var e=0,t=this._getScollBarHorizontalHeight();this.$tbl?(e=this.$tbl[0].offsetHeight-1,this.$tbl.css("marginBottom",t)):e=22;var n=e+t;this.$cont.height(""),this.element.height(""),this.$grid_inner.height(""),this.$vscroll.css("visibility","hidden")},u._setGridWidthFromTable=function(){var e=17;if(this.$vscroll.css("visibility")=="hidden"||this.$vscroll.css("display")=="none")e=0;if(this.$tbl)this.element.width(this.$tbl[0].scrollWidth+e+"px");else{var t=this.$header_left.find("table")[0].scrollWidth;this.element.width(t+"px")}},u._setRightGridWidth=function(){},u._bufferObj_getInit=function(){return this.init},u._bufferObj_getFinal=function(){return this["final"]},u._bufferObj_minRowsPerGrid=function(){var e=this.$cont[0].offsetHeight;return Math.ceil(e/this.rowHeight)},u._calcCurPosFromRowIndxPage=function(e){if(!this.options.treeViewModel)return e;var t=0;for(var n=0,r=this.data.length;n<r;n++){if(n==e)break;var i=this._getRowPQData(n,"hidden");i||t++}return t},u._bufferObj_calcInitFinal=function(){var e=this.data;if(e==null||e.length==0)this["final"]=this.init=null;else if(this.options.flexHeight)this.init=0,this["final"]=e.length-1;else{var t=parseInt(this.$vscroll.pqScrollBar("option","cur_pos"));this.scrollCurPos=parseInt(t),isNaN(t)||t<0?this.init=0:this.init=t,this.init+1>e.length&&(this.init=e.length-1);var n=this._bufferObj_minRowsPerGrid();this.pageSize=n,this["final"]=this.init+n,this["final"]+1>e.length&&(this["final"]=e.length-1)}},u._bufferObj_calcInitFinalH=function(){var e=parseInt(this.$hscroll.pqScrollBar("option","cur_pos")),t=0,n=0,r=this.colModel;for(var i=this.freezeCols,s=r.length;i<s;i++)if(r[i].hidden)t++;else{if(n==e)break;t++,n++}this.initH=t},u._calcWidthCols=function(e){var t=0;this.numberCell&&(t+=this.numberCell_outerWidth);for(var n=0;n<=e;n++)this.colModel[n].hidden||(t+=this.outerWidths
[n]);return t},u._calcRightEdgeCol=function(e){var t=0,n=0;this.numberCell&&(t+=this.numberCell_outerWidth,n++);for(var r=0;r<=e;r++)!this.colModel[r].hidden&&this.hidearrHS[r]==0&&(t+=this.outerWidths[r],n++);return{width:t,cols:n}},u._getDragHelper=function(t){var n=e(t.currentTarget);this.$cl=e("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner),this.$clleft=e("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);var r=parseInt(n.attr("pq-grid-col-indx")),i=this.$grid_inner.outerHeight();this.$cl.height(i),this.$clleft.height(i);var s=e("td[pq-grid-col-indx="+r+"]",this.$header)[0],o=s.offsetLeft+(r>this.options.freezeCols?parseInt(this.$header[1].style.left):0);this.$clleft.css({left:o}),o+=s.offsetWidth,this.$cl.css({left:o})},u._setDragLimits=function(e){var t=this,n=t.$header_left;e>=this.options.freezeCols&&(n=t.$header_right);var r=n.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+e+"]"),i=n.find("td.pq-grid-col[pq-grid-col-indx="+e+"]"),s=i.offset().left+t.minWidth,o=13;if(this.options.flexHeight||this.$vscroll.css("visibility")=="hidden")o=0;var u=t.$cont.offset().left+t.$cont[0].offsetWidth-o+20;r.draggable("option","containment",[s,0,u,0])},u._getOrderIndx=function(e){var t=this.options.columnOrder;return t!=null?t[e]:e},u.nestedCols=function(e,t,n){var r=e.length,i=[];t==null&&(t=1);var s=t,o=0,u=0,a=0;for(var f=0;f<r;f++){var l=e[f];n==1&&(l.hidden=n);if(l.colModel!=null){var c=this.nestedCols(l.colModel,t+1,l.hidden);i=i.concat(c.colModel),c.colSpan>0?(c.depth>s&&(s=c.depth),l.colSpan=c.colSpan,o+=c.colSpan):(l.colSpan=0,l.hidden=!0),l.childCount=c.childCount,a+=c.childCount}else l.hidden?l.colSpan=0:(l.colSpan=1,o++),l.childCount=0,a++,i.push(l)}return{depth:s,colModel:i,colSpan:o,width:u,childCount:a}},u.getHeadersCells=function(){var e=this.options.colModel,t=this.colModel.length,n=this.depth,r=[];for(var i=0;i<n;i++){r[i]=[];var s=0,o=0,u=0;for(var a=0;a<t;a++){var f;if(i==0)f=e[s];else{var l=r[i-1][a],c=l.colModel;if(c==null)f=l;else{var h=a-l.leftPos,p=0,d=0,v=0;for(var m=0;m<c.length;m++){d+=c[m].childCount>0?c[m].childCount:1;if(h<d){v=m;break}}f=c[v]}}var g=f.childCount?f.childCount:1;a==u?(f.leftPos=a,r[i][a]=f,u+=g,e[s+1]&&s++):r[i][a]=r[i][a-1]}}return this.headerCells=r,r},u.assignRowSpan=function(){var e=this.options.colModel,t=this.colModel.length,n=this.headerCells,r=this.depth;for(var i=0;i<t;i++)for(var s=0;s<r;s++){var o=n[s][i];if(i>0&&o==n[s][i-1])continue;if(s>0&&o==n[s-1][i])continue;var u=1;for(var a=s+1;a<r;a++){var f=n[a][i];o==f&&u++}o.rowSpan=u}return n},u._refreshHeader=function(){var e=this.nestedCols(this.options.colModel);this.colModel=e.colModel,this.depth=e.depth,this.getHeadersCells(),this.assignRowSpan()},u._refreshWidths=function(){var t=this;e(this.colModel).each(function(e,n){if(n.width!=undefined){var r=parseInt(n.width);r<t.minWidth&&(r=t.minWidth,n.width=r)}else n.width=t.minWidth})},u._createHeader=function(){var t=this,n="<table class='pq-grid-header-table' cellpadding=0 cellspacing=0>",r=[],i=this.options,s=i.colModel,o=s.length,u=this.colModel,a=u.length,f=this.depth,l=i.columnBorders,c=this.headerCells;if(f>=1){n+="<tr>",this.numberCell&&(n+="<td style='width:"+(this.numberCellWidth+1)+"px;' ></td>");for(var h=0;h<a;h++){var p=u[h];if(p.hidden)continue;var d=parseInt(p.width)+(l?1:0);n+="<td style='width:"+d+"px;'></td>"}n+="</tr>"}for(var v=0;v<f;v++){n+="<tr>",v==0&&this.numberCell&&(n+="<td class='pq-grid-number-col' rowspan='"+f+"'>				<div class='pq-grid-header-table-div'>&nbsp;</div></td>");for(var h=0;h<a;h++){var p=c[v][h],m=p.colSpan;if(v>0&&p==c[v-1][h])continue;if(h>0&&p==c[v][h-1])continue;if(p.hidden)continue;var g="pq-grid-col";p.align=="right"?g+=" pq-align-right":p.align=="center"&&(g+=" pq-align-center"),h==t.freezeCols-1&&f==1&&(g+=" pq-last-freeze-col");var y="",b="";p.colModel==null&&(y="pq-grid-col-indx='"+h+"'"),n+="<td "+y+" "+b+" class='"+g+"' rowspan="+p.rowSpan+" colspan="+m+">				<div class='pq-grid-header-table-div' >"+p.title+"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"}n+="</tr>"}n+="</table>",this.$header.empty(),this.$header.append(n);var w=e(this.$header[0]),E=e(this.$header[1]),S=parseInt(this.options.freezeCols),d=this._calcWidthCols(S-1);w.css({width:d,zIndex:1});var x=0;for(var T=S;T<this.initH+S;T++){var p=u[T];if(p.hidden)continue;var N=this.outerWidths[T];if(N==null)throw"Assert: unknown width";x+=N}E.css({left:"-"+x+"px"}),this.$header.find("td").click(function(){if(!t.options.sortable)return;var n=e(this).attr("pq-grid-col-indx");if(n==null)return;var r=t.colModel[n];if(r.sortable==0)return;var i=r.dataIndx;if(t._trigger("beforeSort",null,{dataModel:t.dataModel,data:t.data,sortIndx:i})==0)return;var s="up",o=t.options.dataModel;o.sortIndx==i&&(s=o.sortDir=="up"?"down":"up"),o.sortIndx=i,o.sortDir=s,t._refreshSortingDataAndView({sorting:!0,keepSelection:!0,fn:function(){t._trigger("sort",null,{dataModel:t.dataModel,data:t.data})}})});var x=0,C=t.$header[0].offsetHeight,k=this.options.direction;for(var T=0;T<this.colModel.length;T++){var L=t.colModel[T];if(t.hidearrHS[T])continue;if(L.hidden)continue;if(L.resizable!=undefined&&L.resizable==0)continue;var A=t.$header_left;T>=t.options.freezeCols&&(A=t.$header_right);var O=e("<div pq-grid-col-indx='"+T+"' class='pq-grid-col-resize-handle'>&nbsp;</div>").appendTo(A),M=t.$header_right.find("td[pq-grid-col-indx="+T+"]")[0];x=parseInt(M.offsetLeft)+parseInt(k=="rtl"?0:M.offsetWidth-10),O.css({left:x,height:C})}var _,D,P,H=t.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(n,r){var i=e(n.target),s=parseInt(i.attr("pq-grid-col-indx"));return t._setDragLimits(s),t._getDragHelper(n,r),i},start:function(e,n){_=n.position.left,P=parseInt(t.$cl[0].style.left)},drag:function(e,n){D=n.position.left;var r=D-_;t.$cl[0].style.left=P+r+"px"},stop:function(n,r){t.$clleft.remove(),t.$cl.remove(),D=r.position.left;var i=D-_,s=e(r.helper),o=parseInt(s.attr("pq-grid-col-indx")),u=t.colModel[o];u.width=parseInt(u.width)+i,t._computeOuterWidths(!0),t._refresh();for(var a=0;a<t.tables.length;a++){var f=t.tables[a].$tbl;f.find("td[pq-top-col-indx='"+o+"']").width(t.outerWidths[o])}}})},u._refreshHeaderSortIcons=function(){var e=this.options.dataModel;if(e.sortIndx==undefined)return;var t=this.$header.find(".pq-grid-col");t.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");var n=e.sortIndx,r=this.getColIndxFromDataIndx(n),i="ui-state-active pq-col-sort-"+(e.sortDir=="up"?"asc":"desc");this.$header.find(".pq-grid-col[pq-grid-col-indx="+r+"]").addClass(i)},u._generateSummaryRow=function(e,t,n,r,i,s,o,u){var a="pq-summary-row",f="",l=this.options.columBorders;f+="<tr pq-row-indx='"+t+"' class='"+a+"'>",u.push(f),this.numberCell&&u.push("<td style='width:"+this.numberCellWidth+"px;' class='pq-grid-number-cell pq-row-selector'>		<div class='pq-td-div'></div></td>");var c={rowIndx:t+s,rowIndxPage:t,rowData:e,summaryCell:!0};for(var h=0;h<r;h++){var p=n[h],d=p.dataIndx;c.column=p,c.colIndx=h;var v=!1,m=e.selectedDataIndices;m&&(v=m[d]);if(p.hidden)continue;if(this.hidearrHS[h])continue;var g="",y=o;p.align=="right"?y+=" pq-align-right":p.align=="center"&&(y+=" pq-align-center"),h==this.freezeCols-1&&l&&(y+=" pq-last-freeze-col"),p.className&&(y=y+" "+p.className),v&&(y+=" pq-cell-select");var b=e[d]==null?"":e[d],w="<td class='"+y+"' style='"+g+"' >			<div>"+b+"</div></td>";u.push(w)}for(var E=0;E<i.length;E++){var h=i[E],p=n[h],d=p.dataIndx;c.column=p,c.colIndx=h;var g="";g+="visibility:hidden;";var y=o;p.align=="right"?y+=" pq-align-right":p.align=="center"&&(y+=" pq-align-center");var b=e[d]==null?"":e[d],w="<td class='"+y+"' style='"+g+"' >			<div>"+b+"</div></td>";u.push(w)}return u.push("</tr>"),u},u.createTable=function(e){this.cTable._generateTables(e)},u._refreshOtherTables=function(){return;var e,t,n},u._sortLocalData=function(t,n,r,i){function u(){function e(e,n){var r=e[t],i=n[t];return r=r?parseInt(r):0,i=i?parseInt(i):0,r-i}function n(e,n){var i=e[t],s=n[t];return r(i,s)}function o(e,n){var r=(e[t]+"").replace(/,/g,""),i=(n[t]+"").replace(/,/g,"");return r=r?parseFloat(r):0,i=i?parseFloat(i):0,r-i}function a(e,n){u++;var r=e[t],i=n[t];return r=r?r:"",i=i?i:"",r>i?1:r<i?-1:0}var u=0;r=="integer"?i=i.sort(e):r=="float"?i=i.sort(o):typeof r=="function"?i=i.sort(n):i=i.sort(a),s=="down"&&(i=i.reverse())}var s=n,o=this;if(i==null||i.length==0)return;e.measureTime(u,"innerSort")},e.widget("paramquery.pqGrid",u),e.paramquery.pqGrid.regional={},e.paramquery.pqGrid.regional.en=u._regional,e.paramquery.pqGrid.setDefaults=function(t){for(var n in t)u.options[n]=t[n];e.widget("paramquery.pqGrid",u),e(".pq-grid").each(function(n,r){e(r).pqGrid("option",t)})},e.measureTime=function(e,t){var n=(new Date).getTime();e();var r=(new Date).getTime(),i=r-n}}(jQuery)